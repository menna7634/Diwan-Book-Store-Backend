import{a as q}from"./chunk-B2KEH2H4.js";import{Ca as E,Fa as _,Ga as f,Ia as I,J as S,L as r,Oa as V,P as F,Pa as D,Ra as H,Sa as A,T as m,Va as L,X as O,aa as l,ba as t,ca as i,cb as N,da as x,fb as z,ha as M,ia as P,ja as k,ka as b,la as s,na as B,oa as h,pa as j,qa as o,ra as g,sa as p,ta as w,ua as $,v as T,w as v,x as u,y,z as C}from"./chunk-VTSCHVBM.js";var R=()=>[1,2,3];function Q(n,a){n&1&&x(0,"div",18)}function Y(n,a){n&1&&(t(0,"div",9)(1,"div",10),x(2,"div",11)(3,"div",12),i(),t(4,"div",13),m(5,Q,1,0,"div",14),i(),t(6,"div",15),x(7,"div",16)(8,"div",17),i()()),n&2&&(r(5),l("ngForOf",E(1,R)))}function J(n,a){n&1&&(M(0),m(1,Y,9,2,"div",8),P()),n&2&&(r(),l("ngForOf",E(1,R)))}function K(n,a){n&1&&(t(0,"div",19)(1,"div",20),y(),t(2,"svg",21),x(3,"path",22)(4,"rect",23)(5,"path",24)(6,"path",25),i()(),C(),t(7,"h3",26),o(8,"No orders yet"),i(),t(9,"p",27),o(10,"Your order history will appear here."),i(),t(11,"a",28),o(12," Start Shopping "),i()())}function W(n,a){if(n&1&&x(0,"img",53),n&2){let e=s().$implicit,d=s(3);l("src",d.bookCover(e),S),O("alt",d.bookTitle(e)+" book cover")}}function X(n,a){n&1&&(t(0,"div",54),y(),t(1,"svg",55),x(2,"path",56)(3,"path",57),i()())}function Z(n,a){if(n&1&&(t(0,"div",50),m(1,W,1,2,"img",51)(2,X,4,0,"div",52),i()),n&2){let e=a.$implicit,d=a.index,c=s(3);B("z-index",10-d),r(),l("ngIf",c.bookCover(e)),r(),l("ngIf",!c.bookCover(e))}}function ee(n,a){if(n&1&&(t(0,"div",58),o(1),i()),n&2){let e=s().$implicit;r(),p(" +",e.books.length-4," ")}}function te(n,a){if(n&1&&x(0,"img",53),n&2){let e=s().$implicit,d=s(4);l("src",d.bookCover(e),S),O("alt",d.bookTitle(e)+" book cover")}}function ie(n,a){if(n&1&&(t(0,"div",74)(1,"div",75),m(2,te,1,2,"img",51),i(),t(3,"div",76)(4,"p",77),o(5),i(),t(6,"p",38),o(7),i()(),t(8,"span",78),o(9),i()()),n&2){let e=a.$implicit,d=s(4);r(2),l("ngIf",d.bookCover(e)),r(3),p(" ",d.bookTitle(e)||e.name," "),r(2),w(" Qty ",e.quantity," \xB7 $",e.price.toFixed(2)," each "),r(2),p(" $",(e.price*e.quantity).toFixed(2)," ")}}function ne(n,a){if(n&1&&(t(0,"span",86),o(1),i()),n&2){let e=s().$implicit;r(),p("\u2014 ",e.note)}}function re(n,a){if(n&1&&(t(0,"p",38),o(1),_(2,"date"),i()),n&2){let e=s().$implicit;r(),p(" ",I(2,1,e.createdAt,"MMM d, y \xB7 h:mm a","+0200")," ")}}function ae(n,a){if(n&1&&(t(0,"div",81),x(1,"div",82),t(2,"div")(3,"span",83),o(4),_(5,"titlecase"),i(),m(6,ne,2,1,"span",84)(7,re,3,5,"p",85),i()()),n&2){let e=a.$implicit;r(4),g(f(5,3,e.status)),r(2),l("ngIf",e.note),r(),l("ngIf",e.createdAt)}}function oe(n,a){if(n&1&&(t(0,"div")(1,"h4",60),o(2," Order History "),i(),t(3,"div",79),m(4,ae,8,5,"div",80),i()()),n&2){let e=s(2).$implicit;r(4),l("ngForOf",e.order_history)}}function de(n,a){if(n&1&&(t(0,"div",59)(1,"div")(2,"h4",60),o(3,"Books"),i(),t(4,"div",61),m(5,ie,10,5,"div",62),i()(),t(6,"div",63)(7,"div",64)(8,"h4",65),o(9," Shipping Address "),i(),t(10,"p",66),o(11),i(),t(12,"p",67),o(13),i(),t(14,"p",67),o(15),i(),t(16,"p",67),o(17),i(),t(18,"p",4),o(19),i()(),t(20,"div",64)(21,"h4",65),o(22," Payment "),i(),t(23,"div",68)(24,"div",69)(25,"span"),o(26,"Method"),i(),t(27,"span",70),o(28),i()(),t(29,"div",69)(30,"span"),o(31,"Status"),i(),t(32,"span",71),o(33),_(34,"titlecase"),i()(),x(35,"hr",72),t(36,"div",73)(37,"span"),o(38,"Total"),i(),t(39,"span"),o(40),i()()()()(),m(41,oe,5,1,"div",5),i()),n&2){let e=s().$implicit,d=s(2);r(5),l("ngForOf",e.books),r(6),g(e.shipping_details.fullName),r(2),g(e.shipping_details.street),r(2),$(" ",e.shipping_details.city,", ",e.shipping_details.state," ",e.shipping_details.zipCode," "),r(2),g(e.shipping_details.country),r(2),p("\u{1F4DE} ",e.shipping_details.phone),r(9),g(d.paymentLabel(e.payment_method)),r(4),h("text-green-600",e.payment_status==="paid")("text-yellow-600",e.payment_status==="pending")("text-red-600",e.payment_status==="failed"),r(),p(" ",f(34,18,e.payment_status)," "),r(7),p("$",d.getOrderTotal(e)),r(),l("ngIf",e.order_history&&e.order_history.length>0)}}function le(n,a){if(n&1){let e=k();t(0,"div",32)(1,"div",33)(2,"div",34)(3,"div",35)(4,"span",36),o(5),i(),t(6,"span",37),o(7),_(8,"titlecase"),i(),t(9,"span",37),o(10),_(11,"titlecase"),i()(),t(12,"span",38),o(13),_(14,"date"),i()(),t(15,"button",39),b("click",function(){let c=v(e).$implicit,U=s(2);return u(U.toggleExpand(c._id))}),o(16),y(),t(17,"svg",40),x(18,"path",41),i()()(),C(),t(19,"div",42)(20,"div",43),m(21,Z,3,4,"div",44)(22,ee,2,1,"div",45),i(),t(23,"span",46),o(24),i(),t(25,"div",47)(26,"p",48),o(27),i(),t(28,"p",38),o(29),i()()(),m(30,de,42,20,"div",49),i()}if(n&2){let e=a.$implicit,d=s(2);r(5),p(" #",e._id.slice(-8).toUpperCase()," "),r(),j(d.statusClass(e.order_status)),r(),p(" ",f(8,32,e.order_status)," "),r(2),h("bg-green-100",e.payment_status==="paid")("text-green-700",e.payment_status==="paid")("bg-yellow-100",e.payment_status==="pending")("text-yellow-700",e.payment_status==="pending")("bg-red-100",e.payment_status==="failed")("text-red-700",e.payment_status==="failed")("bg-gray-100",e.payment_status==="refunded")("text-gray-700",e.payment_status==="refunded"),r(),p(" ",f(11,34,e.payment_status)," "),r(3),p(" ",I(14,36,e.createdAt,"MMM d, y \xB7 h:mm a","+0200")," "),r(3),p(" ",d.expandedOrder===e._id?"Hide Details":"View Details"," "),r(),h("rotate-180",d.expandedOrder===e._id),r(4),l("ngForOf",e.books.slice(0,4)),r(),l("ngIf",e.books.length>4),r(2),w(" ",e.books.length," book",e.books.length!==1?"s":""," "),r(3),p("$",d.getOrderTotal(e)),r(2),g(d.paymentLabel(e.payment_method)),r(),l("ngIf",d.expandedOrder===e._id)}}function se(n,a){if(n&1){let e=k();t(0,"div",87)(1,"button",88),b("click",function(){v(e);let c=s(2);return u(c.loadOrders(c.currentPage-1))}),o(2," Previous "),i(),t(3,"span",89),o(4),i(),t(5,"button",88),b("click",function(){v(e);let c=s(2);return u(c.loadOrders(c.currentPage+1))}),o(6," Next "),i()()}if(n&2){let e=s(2);r(),l("disabled",e.currentPage===1),r(3),w(" Page ",e.currentPage," of ",e.totalPages," "),r(),l("disabled",e.currentPage===e.totalPages)}}function pe(n,a){if(n&1&&(t(0,"div",29),m(1,le,31,40,"div",30)(2,se,7,4,"div",31),i()),n&2){let e=s();r(),l("ngForOf",e.orders)("ngForTrackBy",e.trackById),r(),l("ngIf",e.totalPages>1)}}var G=class n{cartService=T(q);orders=[];loading=!0;expandedOrder=null;currentPage=1;totalPages=1;limit=10;ngOnInit(){this.loadOrders()}loadOrders(a=1){this.loading=!0,this.cartService.getMyOrders(a,this.limit).subscribe({next:({data:e,totalPages:d,currentPage:c})=>{this.orders=e,this.totalPages=d,this.currentPage=c,this.loading=!1},error:()=>{this.loading=!1}})}toggleExpand(a){this.expandedOrder=this.expandedOrder===a?null:a}trackById(a,e){return e._id}bookCover(a){return typeof a.book_id=="object"?a.book_id.book_cover_url??"":""}bookTitle(a){return typeof a.book_id=="object"?a.book_id.book_title:a.name}getOrderTotal(a){return a.books.reduce((e,d)=>e+d.price*d.quantity,0).toFixed(2)}hasHistory(a){return Array.isArray(a.order_history)&&a.order_history.length>0}statusClass(a){return{placed:"bg-yellow-100 text-yellow-700",processing:"bg-blue-100   text-blue-700",shipped:"bg-purple-100 text-purple-700",delivered:"bg-green-100  text-green-700",cancelled:"bg-red-100    text-red-700"}[a]??"bg-gray-100 text-gray-600"}paymentLabel(a){return a==="cash_on_delivery"?"Cash on Delivery":"Card"}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=F({type:n,selectors:[["app-orders"]],decls:11,vars:3,consts:[[1,"min-h-screen","bg-gray-50"],[1,"bg-white","border-b","border-gray-100"],[1,"max-w-4xl","mx-auto","px-4","sm:px-6","lg:px-8","py-8"],[1,"text-2xl","font-bold","text-gray-900"],[1,"text-sm","text-gray-500","mt-1"],[4,"ngIf"],["class","flex flex-col items-center justify-center py-24 gap-4 text-center",4,"ngIf"],["class","flex flex-col gap-4",4,"ngIf"],["class","bg-white rounded-2xl p-5 mb-4 animate-pulse",4,"ngFor","ngForOf"],[1,"bg-white","rounded-2xl","p-5","mb-4","animate-pulse"],[1,"flex","justify-between","mb-4"],[1,"h-4","bg-gray-200","rounded","w-32"],[1,"h-6","bg-gray-100","rounded-full","w-20"],[1,"flex","gap-2","mb-4"],["class","w-10 h-14 bg-gray-200 rounded-lg",4,"ngFor","ngForOf"],[1,"flex","justify-between"],[1,"h-3","bg-gray-100","rounded","w-24"],[1,"h-4","bg-gray-200","rounded","w-16"],[1,"w-10","h-14","bg-gray-200","rounded-lg"],[1,"flex","flex-col","items-center","justify-center","py-24","gap-4","text-center"],[1,"w-20","h-20","rounded-full","bg-primary/10","flex","items-center","justify-center"],["width","36","height","36","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","1.5",1,"text-primary"],["d","M9 5H7a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-2"],["x","9","y","3","width","6","height","4","rx","2"],["d","M9 12h6"],["d","M9 16h4"],[1,"text-xl","font-semibold","text-gray-800"],[1,"text-gray-500","text-sm"],["routerLink","/books",1,"mt-2","px-6","py-3","bg-primary","text-white","rounded-xl","text-sm","font-semibold","hover:bg-primaryHover","transition-all","no-underline"],[1,"flex","flex-col","gap-4"],["class","bg-white rounded-2xl shadow-sm overflow-hidden hover:shadow-md transition-shadow",4,"ngFor","ngForOf","ngForTrackBy"],["class","flex items-center justify-center gap-2 pt-4",4,"ngIf"],[1,"bg-white","rounded-2xl","shadow-sm","overflow-hidden","hover:shadow-md","transition-shadow"],[1,"px-6","py-4","flex","flex-col","sm:flex-row","sm:items-center","justify-between","gap-3","border-b","border-gray-50"],[1,"flex","flex-col","gap-0.5"],[1,"flex","items-center","gap-2","flex-wrap"],[1,"text-sm","font-bold","text-gray-900","font-mono"],[1,"px-2.5","py-0.5","rounded-full","text-xs","font-semibold"],[1,"text-xs","text-gray-400"],[1,"flex","items-center","gap-1.5","px-4","py-2","text-xs","font-semibold","text-primary","hover:bg-primary/10","rounded-xl","transition-all","border-none","bg-transparent","cursor-pointer","self-start","sm:self-auto",3,"click"],["width","14","height","14","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2.5",1,"transition-transform","duration-200"],["d","M6 9l6 6 6-6"],[1,"px-6","py-4","flex","items-center","gap-4"],[1,"flex","-space-x-2"],["class","w-10 h-14 rounded-lg border-2 border-white bg-gray-100 overflow-hidden flex-shrink-0",3,"z-index",4,"ngFor","ngForOf"],["class","w-10 h-14 rounded-lg border-2 border-white bg-gray-100 flex items-center justify-center text-xs font-bold text-gray-500 flex-shrink-0",4,"ngIf"],[1,"flex-1","text-sm","text-gray-500"],[1,"text-right"],[1,"text-base","font-bold","text-gray-900"],["class","px-6 pb-6 border-t border-gray-50 pt-4 flex flex-col gap-5",4,"ngIf"],[1,"w-10","h-14","rounded-lg","border-2","border-white","bg-gray-100","overflow-hidden","flex-shrink-0"],["class","w-full h-full object-cover",3,"src",4,"ngIf"],["class","w-full h-full flex items-center justify-center",4,"ngIf"],[1,"w-full","h-full","object-cover",3,"src"],[1,"w-full","h-full","flex","items-center","justify-center"],["width","14","height","14","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","1.5",1,"text-gray-300"],["d","M4 19.5A2.5 2.5 0 0 1 6.5 17H20"],["d","M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"],[1,"w-10","h-14","rounded-lg","border-2","border-white","bg-gray-100","flex","items-center","justify-center","text-xs","font-bold","text-gray-500","flex-shrink-0"],[1,"px-6","pb-6","border-t","border-gray-50","pt-4","flex","flex-col","gap-5"],[1,"text-xs","font-semibold","text-gray-500","uppercase","tracking-wider","mb-3"],[1,"flex","flex-col","gap-3"],["class","flex gap-3 items-center",4,"ngFor","ngForOf"],[1,"grid","grid-cols-1","sm:grid-cols-2","gap-4"],[1,"p-4","bg-gray-50","rounded-xl"],[1,"text-xs","font-semibold","text-gray-500","uppercase","tracking-wider","mb-2"],[1,"text-sm","text-gray-700"],[1,"text-sm","text-gray-500"],[1,"flex","flex-col","gap-1.5","text-sm"],[1,"flex","justify-between","text-gray-500"],[1,"font-medium","text-gray-800"],[1,"font-medium"],[1,"border-gray-200","my-1"],[1,"flex","justify-between","font-bold","text-gray-900"],[1,"flex","gap-3","items-center"],[1,"w-10","h-14","rounded-lg","bg-gray-100","flex-shrink-0","overflow-hidden"],[1,"flex-1","min-w-0"],[1,"text-sm","font-semibold","text-gray-800","truncate"],[1,"text-sm","font-bold","text-gray-700"],[1,"flex","flex-col","gap-2"],["class","flex items-start gap-3 text-sm",4,"ngFor","ngForOf"],[1,"flex","items-start","gap-3","text-sm"],[1,"w-2","h-2","rounded-full","bg-primary","mt-1.5","flex-shrink-0"],[1,"font-semibold","text-gray-700"],["class","text-gray-400 ml-2",4,"ngIf"],["class","text-xs text-gray-400",4,"ngIf"],[1,"text-gray-400","ml-2"],[1,"flex","items-center","justify-center","gap-2","pt-4"],[1,"px-4","py-2","text-sm","font-medium","rounded-xl","border","border-gray-200","hover:bg-gray-50","transition-all","bg-transparent","cursor-pointer","disabled:opacity-40","disabled:cursor-not-allowed",3,"click","disabled"],[1,"text-sm","text-gray-500","px-2"]],template:function(e,d){e&1&&(t(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1",3),o(4,"My Orders"),i(),t(5,"p",4),o(6,"Track and manage your order history"),i()()(),t(7,"div",2),m(8,J,2,2,"ng-container",5)(9,K,13,0,"div",6)(10,pe,3,3,"div",7),i()()),e&2&&(r(8),l("ngIf",d.loading),r(),l("ngIf",!d.loading&&d.orders.length===0),r(),l("ngIf",!d.loading&&d.orders.length>0))},dependencies:[L,V,D,z,N,H,A],encapsulation:2})};export{G as OrdersComponent};
